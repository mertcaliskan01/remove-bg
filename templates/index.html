<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title id="page-title">Arka Plan Deƒüi≈ütirici</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1 id="main-title">Arka Plan Deƒüi≈ütirici</h1>
        <button id="lang-btn" class="lang-btn">EN</button>
      </div>
      <p id="description">Resminizi y√ºkleyin ve arka planƒ±nƒ± deƒüi≈ütirin!</p>

      <!-- Flash messages -->
      {% with messages = get_flashed_messages(with_categories=true) %} {% if
      messages %} {% for category, message in messages %}
      <div class="alert alert-{{ category }}" id="flash-message">
        {{ message }}
      </div>
      {% endfor %} {% endif %} {% endwith %}

      <form action="/upload" method="post" enctype="multipart/form-data">
        <div class="upload-container">
          <label for="file" class="upload-label">
            <div class="upload-icon">üìÅ</div>
            <span id="select-image">Resim Se√ßin</span>
          </label>
          <input
            type="file"
            id="file"
            name="file"
            accept=".jpg,.jpeg,.png"
            required
          />
          <div
            id="file-name"
            class="file-name"
            data-tr="Dosya se√ßilmedi"
            data-en="No file selected"
          >
            Dosya se√ßilmedi
          </div>
        </div>

        <div class="background-selection">
          <h3 id="bg-title">Arka Plan Rengi Se√ßin</h3>

          <!-- Custom Color Input -->
          <div class="custom-color-section">
            <label for="custom-color" id="custom-label"
              >√ñzel Renk (#05339C):</label
            >
            <input
              type="color"
              id="custom-color"
              name="custom-color"
              value="#05339C"
            />
          </div>

          <div class="color-grid">
            <!-- Custom Color Option -->
            <div class="color-option">
              <input
                type="radio"
                id="bg_custom"
                name="background"
                value="custom"
              />
              <label for="bg_custom" class="color-label">
                <div
                  id="custom-preview"
                  class="color-preview"
                  style="background-color: #05339c"
                ></div>
                <span id="custom-text">√ñzel Renk</span>
              </label>
            </div>

            {% for key, value in backgroundColors.items() %}
            <div class="color-option">
              <input type="radio" id="bg{{ key }}" name="background" value="{{
              key }}" {% if key == '1' %}checked{% endif %}>
              <label for="bg{{ key }}" class="color-label">
                {% if 'gradient' in value %}
                <div
                  class="color-preview gradient-{{ value['gradient'] }}"
                ></div>
                {% elif 'color' in value and value['color'] is not none %}
                <div
                  class="color-preview"
                  style="background-color: rgb({{ value['color'][0] }}, {{ value['color'][1] }}, {{ value['color'][2] }});"
                ></div>
                {% else %}
                <div class="color-preview transparent"></div>
                {% endif %}
                <span>{{ value['name'] }}</span>
              </label>
            </div>
            {% endfor %}
          </div>
        </div>

        <div class="output-settings">
          <h3 id="output-title">√áƒ±ktƒ± Ayarlarƒ±</h3>
          <div class="output-options">
            <label for="output-type" id="format-label">Dosya Formatƒ±:</label>
            <select id="output-type" name="output-type">
              <option value="png">PNG (≈ûeffaflƒ±k destekler)</option>
              <option value="jpg">JPG (Daha k√º√ß√ºk dosya)</option>
            </select>
          </div>
        </div>

        <button type="submit" class="submit-btn" id="submit-btn">
          Arka Planƒ± Deƒüi≈ütir
        </button>
      </form>
    </div>

    <script>
      // Language switching
      const texts = {
        tr: {
          title: "Arka Plan Deƒüi≈ütirici",
          description: "Resminizi y√ºkleyin ve arka planƒ±nƒ± deƒüi≈ütirin!",
          selectImage: "Resim Se√ßin",
          noFile: "Dosya se√ßilmedi",
          bgTitle: "Arka Plan Rengi Se√ßin",
          customLabel: "√ñzel Renk (#05339C):",
          customText: "√ñzel Renk",
          outputTitle: "√áƒ±ktƒ± Ayarlarƒ±",
          formatLabel: "Dosya Formatƒ±:",
          submitBtn: "Arka Planƒ± Deƒüi≈ütir",
        },
        en: {
          title: "Background Changer",
          description: "Upload your image and change its background!",
          selectImage: "Select Image",
          noFile: "No file selected",
          bgTitle: "Select Background Color",
          customLabel: "Custom Color (#05339C):",
          customText: "Custom Color",
          outputTitle: "Output Settings",
          formatLabel: "File Format:",
          submitBtn: "Change Background",
        },
      };

      let currentLang = "tr";
      const langBtn = document.getElementById("lang-btn");

      langBtn.addEventListener("click", function () {
        currentLang = currentLang === "tr" ? "en" : "tr";
        langBtn.textContent = currentLang === "tr" ? "EN" : "TR";
        updateTexts();
      });

      function updateTexts() {
        const t = texts[currentLang];
        document.getElementById("page-title").textContent = t.title;
        document.getElementById("main-title").textContent = t.title;
        document.getElementById("description").textContent = t.description;
        document.getElementById("select-image").textContent = t.selectImage;
        document.getElementById("bg-title").textContent = t.bgTitle;
        document.getElementById("custom-label").textContent = t.customLabel;
        document.getElementById("custom-text").textContent = t.customText;
        document.getElementById("output-title").textContent = t.outputTitle;
        document.getElementById("format-label").textContent = t.formatLabel;
        document.getElementById("submit-btn").textContent = t.submitBtn;

        const fileNameEl = document.getElementById("file-name");
        if (
          fileNameEl.textContent === texts.tr.noFile ||
          fileNameEl.textContent === texts.en.noFile
        ) {
          fileNameEl.textContent = t.noFile;
        }
      }

      // Custom color handling
      const customColorInput = document.getElementById("custom-color");
      const customPreview = document.getElementById("custom-preview");
      const customRadio = document.getElementById("bg_custom");

      customColorInput.addEventListener("change", function () {
        customPreview.style.backgroundColor = this.value;
        // Don't change radio value, keep it as 'custom'
      });

      customRadio.addEventListener("change", function () {
        if (this.checked) {
          // Keep radio value as 'custom', don't change it
          customPreview.style.backgroundColor = customColorInput.value;
        }
      });

      // File name display
      document.getElementById("file").addEventListener("change", function (e) {
        const t = texts[currentLang];
        var fileName = e.target.files[0] ? e.target.files[0].name : t.noFile;
        document.getElementById("file-name").textContent = fileName;
      });
    </script>
  </body>
</html>
